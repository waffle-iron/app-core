<template name="myOrchards">

  {{#if checkArray myOrchards}}
    
    <h2 class="page-header">
      Huertos

      {{#if canCreate}}
        <div class="pull-right">
          <a class="btn btn-success" href="{{pathFor 'myorchards.new' userId=userId}}" role="button">A침adir huerto</a>
        </div>
      {{/if}}
    </h2>

    <!-- <div class="map-container">
      {{> googleMap name="exampleMap" options=exampleMapOptions}}
    </div> -->

    <div class="row">

      <div class="col-md-12">

        {{> myOrchardsTable}}

      </div>

    </div>

    <h3>Elementos</h3>

    <div class="row">
      <div class="col-md-12">
        <div class="panel panel-default">
          <table class="table table-condensed">
            <thead>
              <tr>
                <th width="25px"></th>
                <th width="15%">Nombre</th>
                <th>Huerto</th>
                <th width="100px"></th>
              </tr>
            </thead>
            <tbody>
              {{#each myBenchs}}
                {{> myOrchardBenchsTableItem}}
              {{/each}}
              {{#each myTrees}}
                {{> myOrchardTreesTableItem}}
              {{/each}}
            </tbody>
          </table>
        </div>
      </div>
    </div>

  {{else}}
   {{#if canCreate}}
    {{> myOrchardsNoContent}}
   {{else}}
    {{> noPublicContents}}
   {{/if}}
  {{/if}}

</template>

<template name="myOrchardsNoContent">
  <h2 class="page-header">Administra tus huertos</h2>
  
  <div class="row">
    <div class="col-md-12">
      <p>Los huertos de Tiempo de Siembra te facilitan la gesti칩n
        y registro de actividades de tus huertos, adem치s de sugerirte asociaciones
        de cultivos en base a tus plantaciones y m치s cosas.</p>
      {{#autoForm collection="MyOrchards" id="myOrchardsInsert" type="insert"}}
        <fieldset>
          {{> afQuickField autofocus='true' name='name' label='Nombre para tu primer huerto'}}
        </fieldset>
        <button type="submit" class="btn btn-primary">Comenzar</button>
      {{/autoForm}}
    </div>
  </div>
</template>

<template name="myOrchardBenchsTableItem">
  <tr>
    <td>游꺔</td>
    <td>{{name}}</td>
    <td>
      <a href="{{pathFor "myorchards.one" _id=orchardId userId=userId}}">{{myOrchardName orchardId}}</a>
    </td>

    <td>
      {{#if canEdit .}}
        {{#if orchardId}}
          <a href="{{pathFor "myorchards.one.benchs.one.edit" _id=orchardId bench=_id userId=userId}}" class="btn btn-primary btn-xs">
            <i class="fa fa-pencil"></i>
          </a>
        {{else}}
          <a href="{{pathFor "myorchards.benchs.one.edit" userId=userId}}" class="btn btn-primary btn-xs">
            <i class="fa fa-pencil"></i>
          </a>
        {{/if}}
        {{> shareToggle type="bench" _id=_id public=public}}
      {{/if}}
    </td>
  </tr>
</template>

<template name="myOrchardTreesTableItem">
  <tr>
    <td>游꺕</td>
    <td>
      {{#if name}}
        {{name}}
      {{else}}
        {{treeProperty treeId 'variant'}}
      {{/if}}
    </td>
    <td>
      <a href="{{pathFor "myorchards.one" _id=orchardId userId=userId}}">{{myOrchardName orchardId}}</a>
    </td>

    <td>
    {{#if canEdit .}}
      {{#if orchardId}}
        <a href="{{pathFor "myorchards.one.trees.one.edit" _id=orchardId tree=_id userId=userId}}" class="btn btn-primary btn-xs">
          <i class="fa fa-pencil"></i>
        </a>
      {{else}}
        <a href="{{pathFor "myorchards.trees.one.edit" userId=userId}}">
          <i class="fa fa-pencil"></i>
        </a>
      {{/if}}
      {{> shareToggle type="tree" _id=_id public=public}}
    {{/if}}
    </td>
  </tr>
</template>

<template name="myOrchardsTable">
  <div class="panel panel-default">
    <table class="table valign">
      <thead>
        <tr>
          <th width="150">Nombre</th>
          <th>Descripci칩n</th>
          <th width="100px"></th>
        </tr>
      </thead>
      <tbody>
        {{#each myOrchards}}
          {{> myOrchardsTableItem}}
        {{/each}}
      </tbody>
    </table>
  </div>
</template>

<template name="myOrchardsTableItem">

  <tr>
    <td> <a href="{{pathFor 'myorchards.one' userId=userId}}">{{name}}</a> </td>
    <td> <a href="{{pathFor 'myorchards.one' userId=userId}}">{{description}}</a> </td>
    <td>
      <div class="pull-right">
        {{#if canEdit .}}
          <a class="btn btn-xs btn-danger remove-item" href="#">
            <i class="fa fa-trash"></i>
          </a>
          <a class="btn btn-xs btn-primary" href="{{pathFor 'myorchards.one.edit' userId=userId}}">
            <i class="fa fa-pencil"></i>
          </a>
          <button class="btn btn-default btn-xs toggle-public">
            <i class="fa fa-{{lockClass this}}"></i>
          </button>
        {{/if}}
      </div>
    </td>
  </tr>

</template>

<template name="myOrchardsNew">
  <h2 class="page-header">Crear nuevo huerto</h2>
  {{> quickForm collection="MyOrchards" id="myOrchardsInsert" type="insert"}}
</template>

<template name="myOrchardsEdit">
  <h2 class="page-header">Editar: {{myOrchard.name}}</h2>
  {{> quickForm collection="MyOrchards" id="myOrchardsUpdate" type="update" doc=myOrchard}}
</template>
